

<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JSDoc: utility/ValidationUtil.js</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                    
                    
                        <h1 class="navbar-item">Documentation</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Namespaces</h3><ul><li><a href="AuthUtil.html">AuthUtil</a></li><li><a href="Config.html">Config</a></li><li><a href="TokenUtil.html">TokenUtil</a></li><li><a href="ValidationUtil.html">ValidationUtil</a></li></ul><h3>Classes</h3><ul><li><a href="AccountActions.html">AccountActions</a></li><li><a href="AppActions.html">AppActions</a></li><li><a href="AuthService.html">AuthService</a></li><li><a href="ChallengeActions.html">ChallengeActions</a></li><li><a href="ModalActions.html">ModalActions</a></li><li><a href="NavigateActions.html">NavigateActions</a></li><li><a href="PeerplaysAuthActions.html">PeerplaysAuthActions</a></li><li><a href="PeerplaysService.html">PeerplaysService</a></li><li><a href="PrivateAuthService.html">PrivateAuthService</a></li><li><a href="PrivateProfileService.html">PrivateProfileService</a></li><li><a href="ProfileService.html">ProfileService</a></li><li><a href="StorageUtil.html">StorageUtil</a></li><li><a href="StreamService.StreamService.html">StreamService</a></li></ul><h3>Global</h3><ul><li><a href="global.html#dummyDataWrapper">dummyDataWrapper</a></li><li><a href="global.html#translate">translate</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Source</p>
                        <h1>utility/ValidationUtil.js</h1>
                    </header>
                    
                    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {translate} from './GeneralUtils';
import Config from '../utility/Config';
import {UploadFileTypes} from '../constants';
import supportedEmailDomains from '../assets/locales/SupportedEmailDomains.txt';

const PrivateValidationUtils = {
  /**
   * Validate a Streamers Edge username.
   *
   * @param {string} value - Value to validate.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  seUsername(value) {
    var label = void 0;
    var ref = void 0;
    var prefix = void 0;

    prefix = translate('errors.username.prefix1');

    var length = value.length;
    let error = null;

    if (length === 0) {
      error = prefix + translate('errors.username.notEmpty');
    }

    if (length &lt; 3) {
      error = prefix + translate('errors.username.longer');
    }

    if (length > 63) {
      error = prefix + translate('errors.username.shorter');
    }

    if (/\./.test(value)) {
      prefix = translate('errors.username.prefix2');
    }

    ref = value.split('.');

    for (var i = 0, len = ref.length; i &lt; len; i++) {
      label = ref[i];

      if (!/^[~a-z]/.test(label)) {
        error = prefix + translate('errors.username.startLetter');
      }

      if (!/^[~a-z0-9-]*$/.test(label)) {
        error = prefix + translate('errors.username.lettersDigitsDashes');
      }

      if (/--/.test(label)) {
        error = prefix + translate('errors.username.oneDash');
      }

      if (!/[a-z0-9]$/.test(label)) {
        error = prefix + translate('errors.username.endAlphanumeric');
      }

      if (!(label.length >= 3)) {
        error = prefix + translate('errors.username.longer');
      }
    }

    return error;
  },

  /**
   * Validate an email.
   *
   * @param {string} email - Email to validate.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  email(email) {
    let regex = /^(([^&lt;>()[\]\\.,;:\s@\"]+(\.[^&lt;>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

    const validEmailDomain = email.length > 0 ? this.emailDomain(email) : false;

    if (!regex.test(email)) {
      return translate('errors.email.invalid');
    } else if(!validEmailDomain) {
      return translate('errors.email.invalidDomain');
    } else {
      return null;
    }
  },
  /**
   *
   *
   * @param {string} email - Email to validate.
   * @returns {boolean} False if domain name is not valid, otherwise true.
   * @memberof PrivateValidationUtil
   */
  emailDomain(email) {
    const regex=/\.([^\.]+?)$/;

    const acceptedDomains = supportedEmailDomains.split('\n');
    const extractedDomain = regex.exec(email)[1];

    return acceptedDomains.includes(extractedDomain.toUpperCase());
  },

  /**
   * Validate a Streamers Edge password.
   *
   * @param {string} password - String to validate.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  sePassword(password) {
    let length = password.length;
    let regex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[.@$!%^*#])[A-Za-z\d.@$!%^*#]{4,}$/; //(.@!#$%^*)
    let error = null;

    if (length &lt; 3 || length > 63) {
      error = translate('errors.password.lengthRequirement');
    }

    if (!regex.test(password)) {
      error = translate('errors.password.requires');
    }

    return error;
  },

  /**
   * Validate the search text.
   *
   * @param {string} searchText - Text ti validate.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  search(searchText) {
    let length = searchText.length;
    let error = null;

    if (length &lt; 3 || length > 100) {
      error = translate('errors.search.lengthRequirement');
    }

    if (length === 0) {
      error = translate('errors.password.noBlank');
    }

    return error;
  },

  /**
   * Validate a variable is a number.
   *
   * @param {number} number - Passed in variable to check is a number type.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  number(number) {
    if (typeof number !== 'number') {
      return translate('errors.general.beNumber');
    }
  },

  /**
   * Validate that a variable is a number type with decimals.
   *
   * @param {string} decimalInt - Variable to validate is a number.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  decimalInteger(decimalInt) {
    var regexp = /^[0-9]+([,.][0-9]+)?$/g;

    if (!regexp.test('a') &amp;&amp; !Number.isNumber(decimalInt)) {
      return translate('errors.general.beDecimalOrInt');
    }
  },

  /**
   * Validate a date.
   *
   * @param {Date} date - Variable to validate.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  startDate(date) {
    const today = new Date();
    let error = null;

    if (!Date.parse(date)) {
      error = translate('errors.date.invalid');
    }

    if (today.toDateString() !== date.toDateString()) {
      error = translate('errors.date.beToday');
    }

    return error;
  },

  /**
   * Validate that a pair of dates are correct. EndDate must be greater than start date.
   *
   * @param {Date} startDate - Date one.
   * @param {Date} endDate - Date two.
   * @returns {string} Error if one is found.
   * @memberof PrivateValidationUtil
   */
  endDate(startDate, endDate) {
    let error = null;

    if (!Date.parse(startDate) || !Date.parse(endDate)) {
      error = translate('errors.date.invalid');
    }

    if (Date.parse(startDate) > Date.parse(endDate)) {
      error = translate('errors.date.startLessThanEnd');
    }

    return error;
  },

  /**
   * Validate an uploaded file's type.
   *
   * @param {Blob} file - File to validate, must be jpeg or png.
   * @returns {boolean} An error string if failed, null if passed.
   * @memberof PrivateValidationUtil
   */
  isImageType(file) {
    return (Config.imageUpload.validTypes.every((type) => file.type !== type))
      ? translate('errors.profile.invalidImageType')
      : null;
  },

  /**
   * Validate an uploaded file's size.
   *
   * @param {Blob} file - File to validate.
   * @param {string} type - Type of file to validate.
   * @returns {string} An error string if failed, null if passed.
   * @memberof PrivateValidationUtil
   */
  fileSize(file, type) {
    switch (type) {
      case UploadFileTypes.IMAGE.PROFILE:
        return (file.size > Config.imageUpload.sizeLimit)
          ? translate('errors.profile.invalidImageSize')
          : null;
      // no default
    }
  }
};

/**
 * Auth Util functions.
 *
 * @namespace ValidationUtil
 */
const ValidationUtil = {
  /**
   * Validate a bounty is a decimal integer.
   *
   * @param {string} number - Variable to validate.
   * @returns {string} Error if one is found.
   * @memberof ValidationUtil
   */
  bounty(number) {
    return PrivateValidationUtils.decimalInteger(number);
  },

  /**
   * Validate challenge conditions are a decimal integer.
   *
   * @param {string} number - Variable to validate.
   * @returns {string} Error if one is found.
   * @memberof ValidationUtil
   */
  challengeConditions(number) {
    return PrivateValidationUtils.decimalInteger(number);
  },

  /**
   * Checks if the profile image to upload is valid depending on the use case defined by `type`.
   *
   * @param {Blob} file - File to validate.
   * @param {string} type - Type of file to validate.
   * @returns {string}
   * @memberof ValidationUtil
   */
  imageUpload(file, type) {
    const validType = PrivateValidationUtils.isImageType(file);
    const validSize = PrivateValidationUtils.fileSize(file, type);
    let err;

    // The type is invalid but the size is valid.
    if (!!validType &amp;&amp; !validSize) {
      err = validType;
    }

    // The size is invalid but the type is valid.
    if (!!validSize &amp;&amp; !validType) {
      err = validSize;
    }

    // Both are invalid.
    if (!!validType &amp;&amp; !!validSize) {
      err = translate('errors.profile.invalidTypeAndSize');
    }

    if (!validType &amp;&amp; !validSize) {
      err = null;
    }

    return err;
  },

  /**
   * Validate a string is a username.
   *
   * @deprecated
   * @param {string} string - String to validate.
   * @returns {string} Error if one is found.
   * @memberof ValidationUtil
   */
  inviteGamer(string) {
    return PrivateValidationUtils.username(string);
  },

  /**
   * Validate a Streamers Edge password.
   *
   * @param {string} pass - Password from form to validate.
   * @returns {string} - Error if one is found.
   * @memberof ValidationUtil
   */
  sePassword(pass) {
    return PrivateValidationUtils.sePassword(pass);
  },

  /**
   * Validate an email.
   *
   * @param {string} email - Email to validate.
   * @returns {string} Error if one is found.
   * @memberof ValidationUtil
   */
  email(email) {
    return PrivateValidationUtils.email(email);
  },

  /**
   * Validate a Streamers Edge username.
   *
   * @param {string} string - Value to validate.
   * @returns {string} Error if one is found.
   * @memberof ValidationUtil
   */
  seUsername(string) {
    return PrivateValidationUtils.seUsername(string);
  }
};

export default ValidationUtil;</code></pre>
        </article>
    </section>




                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Thu Aug 08 2019 14:01:08 GMT-0300 (ADT)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers</a>
        </p>
    </div>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
